---
layout:     post
title:      TCP三次握手四次挥手
subtitle:   TCP三次握手四次挥手
date:       2019-05-11
author:     WLX
header-img:  
catalog: 	 true
tags:
    - 协议
---

- TCP三次握手四次挥手
1. 谁先断开连接，谁就会有等待（TIME_WAIT），等待两个数据包时长（MSL），资源（端口）不会释放。
2. 四次挥手客户端为什么要等待， 因为客户端发送确认包，确认收到了服务端的close包，如果服务端没有收到这个包，会再次发送一遍。
3. 为什么挥手是四次，为什么服务器不把两次发包合成一个？

服务器端接收到客户端的close包后，需要尽快给出回应， 而服务器的close包在于应用层， 应用层代码中close不一定是立即发出的，也可能代码中没有close，不发这个包，两个包时间上
不一样，所以拆分开

4. 服务器发送close包后，会不会因为等待客户端的确认而保留资源呢？

会， 会有个超时时间控制。而且一旦出现超时，服务器端会重发一次close包给客户端。

![](http://wx4.sinaimg.cn/mw690/dc889cfaly1g38tx4xhsaj21320nre0t.jpg) 